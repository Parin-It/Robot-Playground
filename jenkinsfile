pipeline{
    agent any

    stages{
        stage('Running Test'){
            steps{
                sh "robot -d result TestCase.robot"
                    robot(
                        outputPath: './result',
                        outputFileName: 'output.xml',
                        reportFIlename: 'report.html',
                        logFileName: 'log.html'
                        disableArchiveOutput: false,
                        passThreshold: 100.0,
                        unstableThreshold: 100.0,
                        otherFiles: '*.png,*.jpg',
                        onlyCritical: false
                    )
                script{
                    common = load "common.groovy"
                    common.updateGithubStatus("pending")
                    echo "test"
                }
            }
        }
    }

    post{
        always{
            script{
                if("${currentBuild.currentResult}" == 'SUCCESS'){
                    common.updateGithubStatus("success")
                }else{
                    common.updateGithubStatus("failure")
                }
            }
        }
    }

}